<?php

/*
 * Universal Theme addon for Bear CMS
 * https://github.com/bearcms/universal-theme-addon
 * Copyright (c) Amplilabs Ltd.
 * Free to use under the MIT license.
 */

return <<<'EOT'
var bearCMS=bearCMS||{};bearCMS.universalTheme=bearCMS.universalTheme||{initializeNavigation:function(){try{responsiveAttributes.run()}catch(t){}var t=document.querySelector(".template-navigation"),e=document.querySelector(".template-navigation-container"),i=null,n=document.querySelector(".template-navigation-items"),a=document.querySelector(".template-navigation-additional-buttons"),o=null!==a,l=document.createDocumentFragment();function d(){var d=e.getAttribute("data-bearcms-universal-theme-navigation-type");if(null!==d){var r="horizontal";"buttonBlock"===d?r="button-block":"buttonDropDown"===d?r="button-drop-down":"buttonOverlay"===d&&(r="button-overlay");var s=e.getAttribute("data-bearcms-universal-theme-navigation-buttons-layout-"+r),v=d+"/"+s;if(i!==v){l.appendChild(n),o&&l.appendChild(a);var c,u,g=function(t,e,i,n){var a="data-bearcms-template-visibility",o=function(){"visible"!==e.getAttribute(a)?(e.setAttribute(a,"visible"),void 0!==i&&i()):(e.removeAttribute(a),void 0!==n&&n())};t.addEventListener("click",(function(){o()})),t.toggle=o},p=null;if("horizontal"===d)t.innerHTML="",p="horizontal-down",t.appendChild(n),o&&t.appendChild(a);else if("buttonBlock"===d){var m="toggleLeft"===s;t.innerHTML='<div class="template-navigation-buttons"><div class="template-navigation-button-toggle-container"><div class="template-navigation-button-toggle"></div></div></div><div class="template-navigation-items-container"></div>';var b=t.lastChild,f=(y=(L=t.firstChild).firstChild).firstChild;b.appendChild(n),o&&(m?L.appendChild(a):L.insertBefore(a,y)),p="none",g(f,b)}else if("buttonOverlay"===d){var h="toggleLeft"===s;m="toggleLeft"===s,t.innerHTML='<div class="template-navigation-items-overlay"><div class="template-navigation-items-background"></div><div class="template-navigation-items-container"><div class="template-navigation-items-close-button-container"><div class="template-navigation-items-close-button"></div></div></div></div><div class="template-navigation-buttons"><div class="template-navigation-button-toggle-container"><div class="template-navigation-button-toggle"></div></div></div>';var C=t.firstChild,w=(b=C.lastChild,f=(y=(L=t.lastChild).firstChild).firstChild,b.firstChild.firstChild);b.appendChild(n),o&&(m?L.appendChild(a):L.insertBefore(a,y)),p=h?"vertical-right":"vertical-left",g(f,C),b.addEventListener("mousedown",(function(t){t.stopPropagation()})),b.addEventListener("click",(function(t){t.stopPropagation()})),C.addEventListener("click",(function(t){t.stopPropagation(),f.toggle()})),w.addEventListener("click",(function(t){t.stopPropagation(),f.toggle()}))}else if("buttonDropDown"===d){var L,y,E="toggleLeft"===s;m="toggleLeft"===s,t.innerHTML='<div class="template-navigation-items-container"></div><div class="template-navigation-buttons"><div class="template-navigation-button-toggle-container"><div class="template-navigation-button-toggle"></div></div></div>',b=t.firstChild,f=(y=(L=t.lastChild).firstChild).firstChild,b.appendChild(n),o&&(m?L.appendChild(a):L.insertBefore(a,y)),p=E?"vertical-right":"vertical-left";var M=function(){var t=b.getBoundingClientRect().width,i=f.getBoundingClientRect(),n=e.getBoundingClientRect(),a=Math.ceil(i.height+i.top-n.top),o=i.left-n.left+(E?0:-t+i.width);o<0&&(o=0);var l=document.body.clientWidth;o+t>l&&(o=l-t),b.style.top=a+"px",b.style.left=o+"px"},z=null;"undefined"!=typeof ResizeObserver&&(z=new ResizeObserver(()=>{M()})),g(f,b,(function(){M(),window.addEventListener("resize",M),window.addEventListener("scroll",M),document.body.addEventListener("mousedown",f.toggle),null!==z&&z.observe(b,{box:"border-box"})}),(function(){window.removeEventListener("resize",M),window.removeEventListener("scroll",M),document.body.removeEventListener("mousedown",f.toggle),null!==z&&z.unobserve(b)})),f.addEventListener("mousedown",(function(t){t.stopPropagation()})),b.addEventListener("mousedown",(function(t){t.stopPropagation()}))}c=p,null!==(u=t.querySelector("ul"))&&u.setAttribute("data-nm-type",c),i=v}}}window.addEventListener("resize",d),window.addEventListener("load",d),window.addEventListener("orientationchange",d),window.addEventListener("css-to-attributes-change",(function(t){-1!==t.elements.indexOf(e)&&d()})),d(),new MutationObserver(d).observe(e,{attributes:!0,childList:!0,subtree:!0})}};
EOT;
